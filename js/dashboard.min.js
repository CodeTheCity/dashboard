/*!
 * stuQuery version 1.0.1
 */
var eventcache={};function S(o){function q(g,i){var t=new Array();var b,a,c,f,h,d;if(i.indexOf(":eq")>=0){b=i.split(" ");for(c=0;c<b.length;c++){if(c==0){d=s(g,b[c])}else{a=new Array();for(f=0;f<d.length;f++){a=a.concat(s(d[f],b[c]))}d=a.splice(0)}}}else{d=g.querySelectorAll(i)}for(h=0;h<d.length;h++){t.push(d[h])}return t}function s(c,d){var f=-1;var a=new Array();if(d.indexOf(":eq")>0){var b=d.replace(/(.*)\:eq\(([0-9]+)\)/,"$1 $2").split(" ");d=b[0];f=parseInt(b[1])}if(d[0]=="."){els=c.getElementsByClassName(d.substr(1))}else{if(d[0]=="#"){els=c.getElementById(d.substr(1))}else{els=c.getElementsByTagName(d)}}if(!els){els=[]}if(els.nodeName&&els.nodeName=="SELECT"){a.push(els)}else{if(typeof els.length!=="number"){els=[els]}for(k=0;k<els.length;k++){a.push(els[k])}if(f>=0&&a.length>0){if(f<a.length){a=[a[f]]}else{a=[]}}}return a}function m(d,a){var c=false;if(a[0]=="."){a=a.substr(1);for(var b=0;b<d.classList.length;b++){if(d.classList[b]==a){return true}}}else{if(a[0]=="#"){if(d.id==a.substr(1)){return true}}else{if(d.tagName==a.toUpperCase()){return true}}}return false}function r(b){var a;if(typeof b==="string"){this.e=q(document,b)}else{if(typeof b==="object"){this.e=(typeof b.length=="number")?b:[b]}}this.length=(this.e?this.e.length:0);return this}r.prototype.ready=function(a){/in/.test(document.readyState)?setTimeout("S(document).ready("+a+")",9):a()};r.prototype.html=function(a){if(typeof a==="number"){a=""+a}if(typeof a!=="string"&&this.e.length==1){return this.e[0].innerHTML}if(typeof a==="string"){for(var b=0;b<this.e.length;b++){this.e[b].innerHTML=a}}return this};r.prototype.append=function(a){if(!a&&this.e.length==1){return this.e[0].innerHTML}if(a){for(var b=0;b<this.e.length;b++){this.e[b].innerHTML+=a}}return this};r.prototype.prepend=function(b){if(!b&&this.e.length==1){return this.e[0].innerHTML}if(b){for(var a=0;a<this.e.length;a++){this.e[a].innerHTML=b+this.e[a].innerHTML}}return this};r.prototype.before=function(f){var c=document.createElement("div");c.innerHTML=f;var d=c.childNodes;for(var a=0;a<el.length;a++){for(var b=0;b<d.length;b++){el[a].parentNode.insertBefore(d[b],el[a])}}return this};r.prototype.after=function(a){for(var b=0;b<this.e.length;b++){this.e[b].insertAdjacentHTML("afterend",a)}return this};function n(c,a){if(c&&c.length>0){for(var b=0;b<c.length;b++){if(c[b].node==a){return{success:true,match:b}}}}return{success:false}}function p(d,a,b,c,f){if(!eventcache[a]){eventcache[a]=new Array()}eventcache[a].push({node:d,fn:b,fn2:c,data:f})}function e(a){if(eventcache[a.type]){var b=n(eventcache[a.type],a.currentTarget);if(b.success){if(b.match.data){a.data=eventcache[a.type][b.match].data}return{fn:eventcache[a.type][b.match].fn,data:a}}}return function(){return{fn:""}}}r.prototype.off=function(a){if(typeof Element.prototype.removeEventListener!=="function"){Element.prototype.removeEventListener=function(f,i){if(!oListeners.hasOwnProperty(f)){return}var t=oListeners[f];for(var d=-1,u=0;u<t.aEls.length;u++){if(t.aEls[u]===this){d=u;break}}if(d===-1){return}for(var g=0,h=t.aEvts[d];g<h.length;g++){if(h[g]===i){h.splice(g,1)}}}}for(var b=0;b<this.e.length;b++){var c=n(eventcache[a],this.e[b]);if(c.success){this.e[b].removeEventListener(a,eventcache[a][c.match].fn2,false);eventcache[a].splice(c.match,1)}}return this};r.prototype.on=function(a,g,b){a=a||window.event;this.cache=[4,5,6];if(typeof g==="function"&&!b){b=g;g=""}if(typeof b!=="function"){return this}if(this.e.length>0){var f=this;var d=function(i){var h=e({currentTarget:this,type:a,data:g,originalEvent:i});if(typeof h.fn==="function"){return h.fn.call(f,h.data)}};for(var c=0;c<this.e.length;c++){p(this.e[c],a,b,d,g);if(this.e[c].addEventListener){this.e[c].addEventListener(a,d,false)}else{if(this.e[c].attachEvent){this.e[c].attachEvent(a,d)}}}}return this};r.prototype.trigger=function(a){var b;if(document.createEvent){b=document.createEvent("HTMLEvents");b.initEvent(a,true,true)}else{b=document.createEventObject();b.eventType=a}b.eventName=a;for(var c=0;c<this.e.length;c++){if(document.createEvent){this.e[c].dispanelEvent(b)}else{this.e[c].fireEvent("on"+b.eventType,b)}}return this};r.prototype.focus=function(){if(this.e.length==1){this.e[0].focus()}return this};r.prototype.blur=function(){if(this.e.length==1){this.e[0].blur()}return this};r.prototype.remove=function(){if(!this.e){return this}for(var a=this.e.length-1;a>=0;a--){if(!this.e[a]){return}if(typeof this.e[a].remove==="function"){this.e[a].remove()}else{if(typeof this.e[a].parentElement.removeChild==="function"){this.e[a].parentElement.removeChild(this.e[a])}}}return S(this.e)};r.prototype.hasClass=function(b){var c=true;for(var a=0;a<this.e.length;a++){if(!this.e[a].className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))){c=false}}return c};r.prototype.toggleClass=function(b){for(var a=0;a<this.e.length;a++){if(this.e[a].className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))){this.e[a].className=this.e[a].className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)","g")," ").replace(/ $/,"")}else{this.e[a].className=(this.e[a].className+" "+b).replace(/^ /,"")}}return S(this.e)};r.prototype.addClass=function(b){for(var a=0;a<this.e.length;a++){if(!this.e[a].className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))){this.e[a].className=(this.e[a].className+" "+b).replace(/^ /,"")}}return S(this.e)};r.prototype.removeClass=function(b){for(var a=0;a<this.e.length;a++){while(this.e[a].className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))){this.e[a].className=this.e[a].className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)","g")," ").replace(/ $/,"").replace(/^ /,"")}}return S(this.e)};r.prototype.css=function(a){var h;for(var b=0;b<this.e.length;b++){h={};var i=this.e[b].getAttribute("style");if(i){var d=this.e[b].getAttribute("style").split(";");for(var c=0;c<d.length;c++){var g=d[c].split(":");if(g.length==2){h[g[0]]=g[1]}}}if(typeof a==="object"){for(key in a){h[key]=a[key]}var f="";for(key in h){if(f){f+=";"}if(h[key]){f+=key+":"+h[key]}}this.e[b].setAttribute("style",f)}}if(this.e.length==1&&typeof a==="string"){return h[a]}return S(this.e)};r.prototype.parent=function(){var a=[];for(var b=0;b<this.e.length;b++){a.push(this.e[b].parentElement)}return S(a)};r.prototype.children=function(a){if(typeof a==="string"){var d=[];for(var c=0;c<this.e.length;c++){for(var b=0;b<this.e[c].children.length;b++){if(m(this.e[c].children[b],a)){d.push(this.e[c].children[b])}}}return S(d)}else{for(var c=0;c<this.e.length;c++){this.e[c]=(this.e[c].children.length>a?this.e[c].children[a]:this.e[c])}return S(this.e)}};r.prototype.find=function(c){var a=[];var d=new Array();for(var b=0;b<this.e.length;b++){d=d.concat(q(this.e[b],c))}return S(d)};r.prototype.attr=function(d,a){var b=[];for(var c=0;c<this.e.length;c++){b.push(this.e[c].getAttribute(d));if(typeof a==="string"||typeof a==="number"){if(a){this.e[c].setAttribute(d,a)}else{this.e[c].removeAttribute(d)}}}if(b.length==1){b=b[0]}if(typeof a==="undefined"){return b}else{return S(this.e)}};r.prototype.prop=function(d,a){var b=[];for(var c=0;c<this.e.length;c++){b.push(this.e[c].getAttribute(d));if(typeof a==="boolean"){if(a){this.e[c].setAttribute(d,d)}else{this.e[c].removeAttribute(d)}}}if(b.length==1){b=b[0]}return b};r.prototype.clone=function(){var a=document.createElement("div");a.appendChild(this.e[0].cloneNode(true));return a.innerHTML};r.prototype.replaceWith=function(c){var b=document.createElement("span");b.innerHTML=c;var a=S(this.e);for(var d=0;d<this.e.length;d++){a.e[0].parentNode.replaceChild(b,a.e[0])}return a};r.prototype.ajax=function(a,b){if(typeof a!=="string"){return false}if(!b){b={}}b.url=a+(typeof b.cache==="boolean"&&!b.cache?"?"+(new Date()).valueOf():"");var f=(window.XMLHttpRequest)?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");f.addEventListener("load",d);f.addEventListener("error",c);function d(h){if(f.status===200){b.header=f.getAllResponseHeaders();if(typeof b.complete==="function"){b.complete.call((b["this"]?b["this"]:this),(b.dataType=="json")?JSON.parse(f.responseText):f.responseText,b)}}else{c(h)}}function c(h){if(typeof b.error==="function"){b.error.call((b["this"]?b["this"]:this),h,b)}}try{f.open("GET",a)}catch(g){c(g)}try{f.send()}catch(g){c(g)}return this};r.prototype.loadJSON=function(b,a,c){if(!c){c={}}c.dataType="json";c.complete=a;this.ajax(b,c);return this};return new r(o)}window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1000/60)}})();
/*!
 * ODI Leeds Dashboard (version 1)
 */
function Dashboard(i){if(!i){i={}}this.panels=new Array();this.year="";this.duration=1000;this.config={};this.panellookup={};var a={};this.setup=function(s){if(!s){s={}}if(typeof s.year==="string"){this.year=S(s.year).e[0].value}if(s.config){this.config=s.config}var o=0;for(var t in this.config){var r=S("#"+t);this.panellookup[t]=o;this.panels[o]={el:r,updateable:new Array(),id:t,config:this.config[t]};if(this.config[t].data){var q=this.config[t].data;if(!a[q]){S().ajax(q,{complete:g,"this":this,error:m,i:o,me:this,cache:false})}else{g(this.panels[a[q]].data,{i:o,me:this})}this.panels[o].el.on("click",{me:this,i:o},function(p){location.href="#"+p.data.me.panels[p.data.i].id})}o++}S("#range").on("change",{me:this},function(p){p.data.me.year=p.currentTarget.value;p.data.me.update()})};function c(p,o){z="0";p=p+"";l=p.length;return l>=o?p:new Array(o-l+1).join(z)+p}function n(p,s,q){if(typeof s!=="number"){s=p.html();if(s){s=parseFloat(s)}p.html("")}var t=new Date();var o;function r(){var u=new Date();var v=(u-t)/q;if(v<1){o=b(Math.round(s*v));p.html(o);requestAnimFrame(r)}else{p.html(b(s))}}if(typeof s==="number"){r()}return}function e(q,r,s){if(s>0){d(q,r,s)}else{var o="<ol>";for(var p=0;p<r.length;p++){o+="<li>"+r[p]+"</li>"}o+="</ol>";q.html(o)}}function d(p,q,r){if(!q){return}var t=new Date();var o=-1;function s(){var v=new Date();var x=(v-t)/r;var y=Math.floor(q.length*x);var u=new Array();if(y>o){for(var w=0;w<y;w++){u.push(q[w])}}if(x<1){e(p,u);requestAnimFrame(s)}else{e(p,q)}}s();return}function f(q){var r=q.getBoundingClientRect();var p=window.pageYOffset?window.pageYOffset:(document.documentElement?document.documentElement.scrollTop:(document.body?document.body.scrollTop:0));var o=window.pageXOffset?window.pageXOffset:(document.documentElement?document.documentElement.scrollLeft:(document.body?document.body.scrollLeft:0));return{top:(r.top+p),left:(r.left+o),width:(r.width),height:(r.height)}}function g(r,o){if(typeof r==="string"){r=r.replace(/\r/,"");r=r.split(/[\n]/)}o.me.panels[o.i].data=r;var q=o.header.split(/[\n\r]/);var s={};for(var p=0;p<q.length;p++){if(q[p]){j=q[p].indexOf(":");s[q[p].substr(0,j)]=q[p].substr(j+1).replace(/^ */,"")}}o.me.panels[o.i].head=s;o.me.updatePanel(o.i);a[o.url]=o.i;if(o.me.panels[o.i].id==o.me.anchor){this.navigate({},o.me.anchor)}return}function m(o){console.log("fail",o)}function b(o){if(typeof o!=="number"){return o}if(o>10000000){return Math.round(o/1000000)+"M"}if(o>1000000){return(o/1000000).toFixed(1)+"M"}if(o>100000){return Math.round(o/1000)+"k"}if(o>10000){return Math.round(o/1000)+"k"}return o}this.update=function(){for(var o=0;o<this.panels.length;o++){if(this.panels[o]&&this.panels[o].data){this.updatePanel(o)}}};this.updatePanel=function(J){var C,G,B;if(this.panels[J]){var V=new Array();if(!this.panels[J].data){return}for(var H=1;H<this.panels[J].data.length;H++){B=this.panels[J].data[H].split(/\,/);V.push(B)}this.panels[J].el=S("#"+this.panels[J].id);for(var Q in this.panels[J].config.els){var K=this.panels[J].el.find(Q);var q=this.panels[J].config.els[Q];if(K.length==0){continue}if(Q==".lastupdated"&&this.panels[J].head["Last-Modified"]){var T=new Date(this.panels[J].head["Last-Modified"]);K.html(T.getUTCFullYear()+"-"+c(T.getUTCMonth()+1,2)+"-"+c(T.getUTCDate(),2));continue}if(q.text){K.html(q.text);continue}var u=this.panels[J].config.start||"";var P=this.panels[J].config.end||"";var v=q.col||"";var Y=q.img||"";var w=q.row||"";if(w){if(w=="all"){if(q.type=="list"){var R=new Array();var U=parseInt(q.url);for(var H=0;H<V.length;H++){var F=V[H][u-1];var Q=(new Date()).toISOString();if(P&&V[H][P-1]){Q=V[H][P-1]}if(this.inDateRange(F,Q)){R.push((U?'<a href="'+V[H][U-1]+'">':"")+(V[H][Y-1]?'<img src="data/'+V[H][Y-1]+'" alt="'+V[H][v-1]+'" title="'+V[H][v-1]+'" />':V[H][v-1])+(U?"</a>":""))}}this.panels[J].updateable.push({el:Q,n:K,list:R,duration:(q.animate?this.duration:0)})}else{if(q.type=="graph"){var I;var E=0;var M={};var o,t,F;function O(p){return{y:parseInt(p.substr(0,4)),m:parseInt(p.substr(5,2))}}for(var H=0;H<V.length;H++){F=V[H][u-1];if(this.inDateRange(F)){if(!o){o=F}}else{if(o&&!t){t=V[H-1][u-1]}}}if(!t){t=V[V.length-1][u-1]}o=O(o);t=O(t);for(var A=o.y;A<=t.y;A++){for(var L=1;L<=12;L++){M[A+"-"+(L<10?"0":"")+L]=0}}var D=0;for(var X in M){D++}var N=0.5*("innerHeight" in window?window.innerHeight:document.documentElement.offsetHeight);for(var H=0;H<V.length;H++){o=O(V[H][u-1]);X=o.y+"-"+(o.m<10?"0":"")+o.m;if(typeof M[X]==="number"){M[X]+=parseFloat(V[H][v-1])}}for(var X in M){if(M[X]>E){E=M[X]}}output='<table style="'+N+'px"><tr style="vertical-align:bottom;">';for(var X in M){output+='<td style="width:'+(100/D)+'%;"><div class="bar" title="'+X+": "+M[X]+'" style="height:'+(N*M[X]/E)+'px;"></div>'+(X.indexOf("-01")>0?'<span class="date">'+X.substr(0,4)+"</span>":"")+"</td>"}output+="</tr></table>";K.html(output)}}continue}else{if(w=="last"){w=V.length;if(u){for(var H=0;H<V.length;H++){if(this.inDateRange(V[H][u-1])){w=H+1}}}}else{w=parseInt(w)}}val=V[w-1][v-1];if(q.animate){n(K,val,this.duration)}else{K.html(val)}}else{var x=q.op;var C="";if(x&&v){var W=0;for(var H=0;H<V.length;H++){var F=V[H][u-1];var Q=(new Date()).toISOString();if(P&&V[H][P-1]){Q=V[H][P-1]}if(this.inDateRange(F,Q)){if(x=="sum"){W+=parseInt(V[H][v-1])}else{if(x=="count"){W++}}}}if(q.animate){n(K,W,this.duration)}else{K.html(b(W))}}}}}};this.inDateRange=function(r,o){var p=parseInt(r.substr(0,4));var q=(o?parseInt(o.substr(0,4)):p);if(!this.year){return true}if(p<=this.year&&q>=this.year){return true}else{return false}};this.resize=function(){var p=S(".moreinfo");if(p.length==1){var o="innerHeight" in window?window.innerHeight:document.documentElement.offsetHeight;S(".moreinfo").css({left:"0px",top:"0px",width:document.body.offsetWidth+"px",height:o+"px"})}return this};this.navigate=function(s,p){if(!p){p=location.href.split("#")[1]}var r=this.panellookup[p];S(".moreinfo").remove();if(typeof r==="number"){for(var q=0;q<this.panels[r].updateable.length;q++){e(this.panels[r].updateable[q].n,this.panels[r].updateable[q].list,this.panels[r].updateable[q].duration)}this.panels[r].el=S("#"+this.panels[r].id);var t=f(this.panels[r].el.e[0]);S(".main").after('<div class="moreinfo '+this.panels[r].config["class"]+'"></div>');S("body").css({"overflow-y":"hidden"});S(".moreinfo").html('<div class="close">&times;</div>'+this.panels[r].el.html()).css({width:t.width+"px",height:t.height+"px",left:t.left+"px",top:t.top+"px"}).css({left:"0px",top:"0px",width:document.body.offsetWidth+"px",height:("innerHeight" in window?window.innerHeight:document.documentElement.offsetHeight)+"px"});S(".moreinfo .close").on("click",{me:this},function(o){location.href=o.data.me.href+"#top"})}else{S("body").css({"overflow-y":""})}return this};this.pushstate=!!(window.history&&history.pushState);this.href=location.href.split("#")[0];this.anchor=location.href.split("#")[1];var h=this;window.addEventListener("resize",function(o){h.resize()});window[(this.pushstate)?"onpopstate":"onhashchange"]=function(o){h.navigate(o)};return this};